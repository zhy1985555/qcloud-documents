## 基本概念
微服务引擎的北极星场景下与账号和用户相关的概念如下：
- **用户账号**：分为**腾讯云主账号**和**腾讯云子账号**两种类型。TSE支持沿用腾讯云的账号体系，无需额外创建。
- **主账号**：也可称为主用户，是所有北极星资源的拥有者，对所有北极星资源有操作权限。在创建TSE引擎的时候，TSE 默认会关联**腾讯云主账号**。
- **子账号**：对应腾讯云子账号（子用户或者协作者）。
- **用户组**：北极星的用户组概念，是一组具有相同权限的用户。主账号可以通过创建用户组批量对用户进行授权与管理。**用户组只能由主账号创建和授权。**
- **授权**：主用户可以管理所有子用户以及用户分组的写权限。子用户可将自己拥有写权限的资源权限分配给其他子用户或者用户组。
- **token**：资源权限将通过token进行控制和管理，用户与用户组均可生成。

## 操作场景
使用 Polarismesh(北极星) 的鉴权功能，您可以清晰地管理资源与用户的访问权限。北极星基于**命名空间**和**服务**资源维度实现权限管控。
北极星引入策略的概念，将资源的访问权限与不同的用户角色联系到一起。例如下图，![](https://qcloudimg.tencent-cloud.cn/raw/39600d0a8ced25c7d617c9bfad40193e.jpg)
子账号和用户组默认没有写资源的权限，需要主账号为其授权，才能使子账号/用户组具有指定资源的操作权限。

本文指导您在 [TSE控制台](https://console.cloud.tencent.com/tse) 通过开启资源鉴权和新建策略，在主账号、子账号、资源视角下，为用户或用户组授予资源权限。

## 前提条件
主账号至少拥有一个 Polarismesh 引擎实例。若您没有，请前往 [创建引擎](https://cloud.tencent.com/document/product/1364/65866)。

## 操作步骤
### 步骤一：开启鉴权模式
1. 使用腾讯云**主账号**登录 [TSE控制台](https://console.cloud.tencent.com/tse)，单击 Polarismesh，进入北极星引擎实例管理页面。
2. 单击已有的北极星**引擎实例**，进入北极星引擎控制台，在左侧导航栏中，选择**基本信息**，进入引擎基本信息管理页面。
3. 在**鉴权**卡片中，单击**服务鉴权**的开关按钮。![](https://qcloudimg.tencent-cloud.cn/raw/6921a67809f50be9bf0f0c2961e94655.png)
4. 单击**确认**开启服务鉴权后，子账号或用户组进行访问控制台、访问北极星资源等操作时，都会需要使用token鉴权，没有配置token的客户端将无法注册服务。只有在服务鉴权开启的情况下，控制台左侧的导航栏才会出现**权限管理**选项。

### 步骤二：导入腾讯云账号
1. 在主账号场景下，进入北极星引擎控制台，单击左侧导航栏的**权限管理**，进入权限策略管理页面。
2. 单击**导入腾讯云账号**，引擎将为您自动导入当前腾讯云主账号下的所有子账号。![](https://qcloudimg.tencent-cloud.cn/raw/1d5d1288108fd1d0681d9beda6845ff4.jpg)
3. 主账号可在**权限管理**页面中查看所有用户或用户组的 token，并且对用户、用户组和权限策略做管理和编辑。![](https://qcloudimg.tencent-cloud.cn/raw/5f01ca66a61fa549880c92ee3875e8c5.jpg)

### 步骤三：关联用户组
1、在北极星引擎控制台，**权限管理** > **用户组**中，单击**新建用户组**。![](https://qcloudimg.tencent-cloud.cn/raw/bc55b1c65cf9e39ad266ccecc1fc65e6.png)
2. 根据您的需要，为用户组命名，并且关联子账号。![](https://qcloudimg.tencent-cloud.cn/raw/93a1c09bc4d015889cf960cce1c745c8.jpg)
3. **只有主账号可对用户组进行编辑操作**。

### 步骤四：授权操作
您可以通过以下列表查看不同视角的授权操作。
<dx-tabs> 
::: 主账号视角
1. 使用腾讯云**主账号**登录 [TSE控制台](https://console.cloud.tencent.com/tse) ，单击 Polarismesh，进入北极星引擎实例管理页面。
2. 单击已有的北极星**引擎实例**，进入北极星控制台，在**基本信息** > **鉴权**中，确认**服务鉴权**已开启。![](https://qcloudimg.tencent-cloud.cn/raw/2e7a3e2425fbb633d191003b2c88c5bf.png)
3. 单击左侧导航栏**权限管理**，进入权限管理页面。选择**权限策略**页签，单击新建策略。填写策略基本信息，在角色栏可以选择需要授权用户或用户组，单击**下一步**选择授权的资源。![](https://qcloudimg.tencent-cloud.cn/raw/04586e2659544cf88d32067328b144cd.jpg)
4. 在资源栏可选择北极星的资源类型，包括命名空间、服务等资源，主账号可对所有资源进行操作。![](https://qcloudimg.tencent-cloud.cn/raw/741c0c6fdfc1c645fcd4a26148620b2d.png)
5. 单击**下一步**，进入预览界面，详细展示该策略涉及的用户、用户组以及资源。确认信息无误后，单击**完成**。
6. 主账号可在权限策略列表查阅现有的权限策略，可单击**编辑**进行授权或删除等操作。![](https://qcloudimg.tencent-cloud.cn/raw/09524f642112475ff3bc357ea53126cf.jpg)

:::
::: 子账号视角
1. 仅在主账号开启了**鉴权**模式下，使用腾讯云子账号登录 [TSE控制台](https://console.cloud.tencent.com/tse)，进入北极星控制台，左侧的导航栏才会出现**权限管理**选项，单击可进入权限管理列表。
2. 子用户**无法**新建和编辑权限策略，只能查看现有权限策略。![](https://qcloudimg.tencent-cloud.cn/raw/a15d3a0bef9ffc640cc0b3c5ee3d5833.jpg)
3. 子用户可将自己拥有写权限的资源权限分配给其他子用户或者用户组。具体操作请参见**资源视角**。
	
:::
::: 资源视角
1. 仅在主账号开启了**鉴权**模式下，用户在创建、编辑**命名空间**或**服务**时，才可将该资源授权给其他用户或者用户组。接下来以**命名空间**为例，指导您如何在资源视角给用户授权。
2. 在 [TSE控制台](https://console.cloud.tencent.com/tse) > **polarismesh**，选择已存在的北极星引擎实例，进入北极星控制台。在左侧导航栏中，选择**命名空间**，进入命名空间列表管理页面。
![](https://qcloudimg.tencent-cloud.cn/raw/9c9461075f0c26a249de12a99101e3e5.jpg)
3. 单击**新建**，进入新建命名空间页面，根据您的需要填写信息，并且可在**高级设置**中选择需要授权的用户或用户组。![](https://qcloudimg.tencent-cloud.cn/raw/9107c7722ec8689c083147ca87028903.jpg)
4. 单击**提交**，则完成创建命名空间且选择的用户或用户组对该命名空间具有操作权限。
5. 对于已经存在的命名空间，单击**编辑**，可以修改授权的用户或用户组。
:::
</dx-tabs>

## 注意
1. 只有主账号开启服务鉴权功能后，才能在控制台查看**权限管理**列表。
2. 资源隔离性：
	- **所有子用户，对主账号的资源都默认具备读权限。**
	- **所有子用户或者用户分组，都默认获得对所创建的资源的写权限。**
	- 子用户可以获得所在的用户分组的所有资源写权限。
3. 如果您已经开启了鉴权模式，但是未导入账号，子账号将不具备创建服务或者命名空间等资源的权限。
4. 每个用户初始都有一个策略**默认策略**。
	- 子用户没有创建资源的情况下，默认策略中资源为空。
	- 用户创建资源后，自动添加资源至默认策略。
	- 删除资源时，引擎将自动把该资源从默认策略中删除。


