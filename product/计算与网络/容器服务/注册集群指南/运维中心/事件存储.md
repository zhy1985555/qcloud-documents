本文主要介绍如何将注册集群的事件信息接入到 [腾讯云日志服务 CLS](https://cloud.tencent.com/product/cls)。

## 操作场景

Kubernetes Events 包括了 Kuberntes 集群的运行和各类资源的调度情况，对维护人员日常观察资源的变更以及定位问题均有帮助。容器服务支持为您的注册集群配置事件持久化功能，开启本功能后，会将您的集群事件实时导出到配置的存储端。还支持使用腾讯云提供的 PAAS 服务或开源软件对事件流水进行检索。  

## 使用须知
- 已经 [创建注册集群](https://cloud.tencent.com/document/product/457/63218)，且注册集群的状态为运行中。
- 目前注册集群事件信息的持久化存储仅支持 [腾讯云日志服务 CLS](https://cloud.tencent.com/product/cls)，暂不支持其他存储后端。
- 若使用集群事件持久化功能，请确认 Kubernetes 集群内节点能够访问日志消费端。这里我们提供公网和内网两种方式进行事件信息投递，用户可以根据业务情况自行选择：
   - 公网投递：集群事件信息将通过公网的方式进行投递至日志服务 CLS ，需要集群中的节点具有访问公网的能力。
   - 内网投递：集群事件信息将通过内网的方式进行投递至日志服务 CLS ，需要集群内的节点与腾讯云日志服务 CLS 内网互通。选择该选项前，请 [联系我们](https://cloud.tencent.com/online-service) 进行确认。

## 操作步骤

### 开启事件存储
1. 登录 [容器服务控制台 ](https://console.cloud.tencent.com/tke2)，在左侧导航栏中选择**运维功能管理**。
3. 在“功能管理”页面上方选择地域和注册集群，单击需要开启事件存储的集群右侧的**设置**。如下图所示：
   ![](https://qcloudimg.tencent-cloud.cn/raw/153cd85207f50666f078d51bb36c83d9.png)
4. 在“设置功能”页面，单击事件存储**编辑**。
5. 在“事件存储”编辑页面，勾选**开启事件存储**，并配置日志集、日志主题和投递方式。如下图所示：
>! 一个日志集最多只能有 10 个日志主题。若选择自动创建日志主题，请保证该日志集下未满 10 个日志主题。
>
![](https://qcloudimg.tencent-cloud.cn/raw/8fac0174b66d98a4af4d1e1a78b52db4.png)
6. 单击**确定**，即可开启事件存储。

### 更新日志集或日志主题
1. 登录 [容器服务控制台 ](https://console.cloud.tencent.com/tke2)，在左侧导航栏中选择**运维功能管理**。
3. 在“功能管理”页面上方选择地域和注册集群，单击需要开启事件存储的集群右侧的**设置**。
4. 在“设置功能”页面，单击事件存储**编辑**。
5. 在“事件存储”编辑页面，重新选择日志集和日志主题。单击**确定**即可更新日志集和日志主题。

### 关闭事件存储
1. 登录 [容器服务控制台 ](https://console.cloud.tencent.com/tke2)，在左侧导航栏中选择**运维功能管理**。
3. 在“功能管理”页面上方选择地域和注册集群，单击需要开启事件存储的集群右侧的**设置**。
4. 在“设置功能”页面，单击事件存储**编辑**。
5. 在“事件存储”编辑页面，取消勾选**开启事件存储**。如下图所示，
   ![](https://qcloudimg.tencent-cloud.cn/raw/6a92723147f19fb5828e54eb348209f9.png)
6. 单击**确定**，即可关闭事件存储。

## 事件仪表盘
容器服务为用户提供了开箱即用的事件仪表盘。在集群开启事件存储功能后，自动为集群配置各类事件总览大盘和异常事件的聚合检索分析仪表盘。还支持用户自定义配置过滤项，同时内置 CLS 的事件全局检索，实现在容器服务控制台 全面观测、查找、分析、定位问题的能力。更多详细介绍，请参考 [事件仪表盘](https://cloud.tencent.com/document/product/457/50512)。
